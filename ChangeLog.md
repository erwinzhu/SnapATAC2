dev
===================

- Storing full fragment information in `.obms['fragment']`. Single-end reads are
  stored in `.obsm['insertion']` as before.

v2.4.0 (2023-09-12)
===================

- Add multiprocessing support to various preprocessing functions like `pp.import_data`.
- Add experimental `pp.import_contacts` to import scHi-C data.
- Add `pp.scanorama_integrate` to perform batch correction using Scanorama.
- Bug fixes: #145, #148, and others.

v2.3.1 (2023-06-21)
===================

- Bug fixes: #119, #127, #131.
- Add `pp.add_frip` to calculate the fraction of reads in peaks or other types of feature sets.
- Make `pp.make_fragment_file`'s behavior more deterministic.

v2.3.0 (2023-04-14)
===================

## Major changes:

- Updates to `tl.spectral`:
  1. Change the default similarity metric to the cosine similarity.
  2. Significantly improve the scalability of the algorithm when using the cosine similarity. Both the time and space complexity are now linear!
  3. The returned eigenvectors are now weighted by eigenvalues so that using the elbow method to select the number of eigenvectors is no longer necessary. To restore the old behavior, set `weighted_by_sd=False`.
- Implement `tl.multi_spectral` to perform dimension reduction on multiple modalities simultaneously.

## Breaking changes:

- Due to a major upgrade of the `anndata-rs` package. The `AnnData` object generated by older versions is no longer compatible with the new version.
- All dataframes in backed mode are now indexless.
- The `pp.call_doublets` and `pl.scrublet` has been removed. `pp.scrublet` now automatically calls doublets.
- rename the argument `gff_file` to `gene_anno` in `pp.import_data` and `pp.make_gene_matrix`. Because the gene annotation file is no longer required to be a GFF file.

## Bug fixes:

- Fix a bug in `pp.call_doublets` that leads to incorrect thresholds for certain datasets.

## Other changes:

- Fix #80, #97, #102, #103, #109, #110.
- `pp.make_tile_matrix`: allow excluding certain chromosomes by setting `exclude_chroms`.
- Most preprocessing functions can now take a list of `AnnData` objects as input, and
  process them in parallel.

v2.2.0 (2022-12-02)
===================

## Major changes:

- Support in-memory AnnData and flexible conversions between backed and in-memory
  AnnData.

## Breaking changes:

- `create_dataset` has been removed. Please use the `AnnDataSet` constructor to
  create the AnnDataSet object.

### Argument renaming:

- Argument `storage` is renamed to `file` in a variety of AnnData IO functions, including
   `create_dataset`, `read_mtx`, and `read_csv`.
- Argument `no_check` is removed in `read_dataset`.
- `mode` is renamed to `backed` in `.read()`.

v2.1.3 (2022-11-02)
===================

- Minor bug fixes and performance improvements.
- Fix 10X bam file parsing in `pp.make_fragment_file`.
- Add a low-memory mode in `pp.import_data` for parsing large unsorted fragment files.

v2.1.2 (2022-10-01)
===================

Minor bug fixes and performance improvements.

v2.1.1 (2022-09-28)
===================

## Major changes:

- Fix bugs in "ex.export_bigwig". NOTE: prior to this version, this function
  does not work as expected. Please update and rerun if you have used this function
  in v2.1.0.
- Add "tl.motif_enrichment" to perform motif enrichment analysis.

v2.1.0 (2022-09-17)
===================

## Major changes:

- Various bug fixes and performance improvements.
- Add "tl.diff_test" to identify differentially accessible regions.
- Add "tl.make_fragment_file" to convert BAM files to fragment files.
- Add various functions to perform transcriptional regulatory network analysis.
- Add "read_10x_mtx" for reading files produced by 10X CellRanger pipeline.
- Add "ex.export_bigwig" to generate bigwig files.

## Breaking changes:

- "pp.make_tile_matrix" has been renamed to "pp.add_tile_matrix".
- "snapatac2.genome" has been redesigned. A new "Genome" class is added for
  automatic download of gene annotation files. Objects in "snap.genome.*" are
  now instances of the Genome object.
- Rename each occurrence of "group_by" to "groupby" to be consistent with other
  packages.

v2.0.0 (2022-07-07)
===================

Initial release.